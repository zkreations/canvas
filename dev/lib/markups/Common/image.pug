//- Manipular imágenes de servidores de Google
//- @author zkreations
//- @param {image} src - Url de imagen
//- @param {string} [alt=data:messages.image] - Texto de respaldo
//- @param {string} [id] - Identificador único
//- @param {string} [class] - Clases adicionales
//- @param {string} [width] - Ancho de la imagen
//- @param {string} [height] - Alto de la imagen
//- @param {number} [resize=1280] - Cambiar el tamaño
//- @param {string} [ratio] - Relación de aspecto
//- @param {string} [sizes] - Valor del atributo sizes
//- @param {Array} [srcset] - Matriz de tamaños
//- @param {string} [lazyload] - Clase CSS para lazyload
//- @param {string} [loading] - Atributo loading

b:includable(id='$:image')

  b:with(value='resizeImage((data:src.isYoutube ? data:src.youtubeMaxResDefaultUrl : data:src), (data:resize ?: 1280), data:ratio)', var='image')
    b:tag(expr:alt='data:alt ?: data:messages.image', name='img')
      //- Cerrar etiqueta
      b:attr(name='b:whitespace', value='remove')

      //- Asigna una ID unica
      b:attr(name='id', expr:value='data:id')

      //- Obtiene el ancho si existe
      b:attr(name='width', expr:value='data:width ?: data:image.width')

      //- Obtiene el alto si existe
      b:attr(name='height', expr:value='data:height ?: data:image.height')

      //- Agrega las especificaciones del atributo sizes
      b:attr(name='sizes', expr:value='data:sizes')

      //- Atributo loading
      b:attr(name='loading', expr:value='data:loading')

      //- Agrega clases adicionales
      b:class(cond='data:class', expr:name='data:class')

      //- Agrega la clase lazyload
      b:class(cond='data:lazyload', expr:name='data:lazyload')

      //- Si lazyload existe, la variable data es igual a "data-", caso contrario "vacío"
      b:with(value='data:lazyload ? "data-" : ""', var='data')

        //- Si lazyload existe, "src" contiene la imagen de respaldo
        b:attr(cond='data:data',
            name='src',
            value='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==')

        //- Si srcset existe, genera las variantes de tamaños especificados
        //- Si lazyload existe, "srcset" pasa a "data-srcset"
        b:attr(cond='data:srcset',
            expr:name='data:data + "srcset"',
            expr:value='sourceSet(data:image, (data:srcset ?: []), data:ratio)')

        //- Si srcset existe, el valor de "src" equivale a la primera resolución
        //- Si lazyload existe, "src" pasa a "data-src"
        b:attr(expr:name='data:data + "src"',
            expr:value='data:srcset ? resizeImage(data:image, data:srcset.first, data:ratio) : data:image')
